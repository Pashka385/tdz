
const quizData = [
  {
    id: 1,
    question_text: "–ö–∞–∫–æ–≤–∞ –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã?",
    answers: [
      { id: 1, answer_text: "–ü–∏—Å–∞—Ç—å –∫–æ–¥", is_correct: false },
      { id: 2, answer_text: "–£–ø—Ä–∞–≤–ª—è—Ç—å –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã–º–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞", is_correct: true },
      { id: 3, answer_text: "–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç", is_correct: false },
      { id: 4, answer_text: "–†–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫—É", is_correct: false }
    ]
  },
  {
    id: 2,
    question_text: "–ö–∞–∫–æ–π –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ù–ï —è–≤–ª—è–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π?",
    answers: [
      { id: 5, answer_text: "Windows", is_correct: false },
      { id: 6, answer_text: "Linux", is_correct: false },
      { id: 7, answer_text: "Photoshop", is_correct: true },
      { id: 8, answer_text: "macOS", is_correct: false }
    ]
  },
  {
    id: 3,
    question_text: "–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä–∞ –¶–ü?",
    answers: [
      { id: 9, answer_text: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä", is_correct: true },
      { id: 10, answer_text: "–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–π –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ", is_correct: false },
      { id: 11, answer_text: "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ", is_correct: false },
      { id: 12, answer_text: "–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–π –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è", is_correct: false }
    ]
  },
  {
    id: 4,
    question_text: "–ö–∞–∫–æ–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è —è–∑—ã–∫–æ–º –Ω–∏–∑–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è, –±–ª–∏–∑–∫–∏–º –∫ –º–∞—à–∏–Ω–Ω–æ–º—É –∫–æ–¥—É?",
    answers: [
      { id: 13, answer_text: "Python", is_correct: false },
      { id: 14, answer_text: "–ê—Å—Å–µ–º–±–ª–µ—Ä", is_correct: true },
      { id: 15, answer_text: "Java", is_correct: false },
      { id: 16, answer_text: "C++", is_correct: false }
    ]
  },
  {
    id: 5,
    question_text: "–ö–∞–∫–æ–π —Ç–∏–ø –ø–∞–º—è—Ç–∏ —è–≤–ª—è–µ—Ç—Å—è —ç–Ω–µ—Ä–≥–æ–∑–∞–≤–∏—Å–∏–º—ã–º –∏ —Ç–µ—Ä—è–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ –ø–∏—Ç–∞–Ω–∏—è?",
    answers: [
      { id: 17, answer_text: "–ü–ó–£", is_correct: false },
      { id: 18, answer_text: "–û–ó–£", is_correct: true },
      { id: 19, answer_text: "–ñ–µ—Å—Ç–∫–∏–π –¥–∏—Å–∫", is_correct: false },
      { id: 20, answer_text: "SSD", is_correct: false }
    ]
  },
  {
    id: 6,
    question_text: "–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä–∞ HTML?",
    answers: [
      { id: 21, answer_text: "–Ø–∑—ã–∫ —Ä–∞–∑–º–µ—Ç–∫–∏ –≥–∏–ø–µ—Ä—Ç–µ–∫—Å—Ç–∞", is_correct: true },
      { id: 22, answer_text: "–Ø–∑—ã–∫ –≥–∏–ø–µ—Ä—Ç–µ–∫—Å—Ç–æ–≤–æ–π –º–∞—à–∏–Ω—ã", is_correct: false },
      { id: 23, answer_text: "–Ø–∑—ã–∫ —Ä–∞–∑–º–µ—Ç–∫–∏ –≤—ã—Å–æ–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞", is_correct: false },
      { id: 24, answer_text: "–Ø–∑—ã–∫ –≥–∏–ø–µ—Ä—Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü", is_correct: false }
    ]
  },
  {
    id: 7,
    question_text: "–ö–∞–∫–æ–π –ø—Ä–æ—Ç–æ–∫–æ–ª –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ?",
    answers: [
      { id: 25, answer_text: "FTP", is_correct: false },
      { id: 26, answer_text: "SMTP", is_correct: false },
      { id: 27, answer_text: "HTTP", is_correct: true },
      { id: 28, answer_text: "HTTPS", is_correct: false }
    ]
  },
  {
    id: 8,
    question_text: "–ö–∞–∫–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö?",
    answers: [
      { id: 29, answer_text: "–û–ó–£", is_correct: false },
      { id: 30, answer_text: "–¶–ü", is_correct: false },
      { id: 31, answer_text: "–ñ–µ—Å—Ç–∫–∏–π –¥–∏—Å–∫", is_correct: true },
      { id: 32, answer_text: "–ö—ç—à", is_correct: false }
    ]
  },
  {
    id: 9,
    question_text: "–ß—Ç–æ —Ç–∞–∫–æ–µ '–æ—à–∏–±–∫–∞' –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è?",
    answers: [
      { id: 33, answer_text: "–ü—Ä–æ–≥—Ä–∞–º–º–Ω–∞—è –æ—à–∏–±–∫–∞", is_correct: true },
      { id: 34, answer_text: "–ê–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ", is_correct: false },
      { id: 35, answer_text: "–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è", is_correct: false },
      { id: 36, answer_text: "–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è", is_correct: false }
    ]
  },
  {
    id: 10,
    question_text: "–ö–∞–∫–æ–π –∏–∑ —ç—Ç–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ø—É–ª—è—Ä–Ω–æ–π –ø–∞—Ä–∞–¥–∏–≥–º–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è?",
    answers: [
      { id: 37, answer_text: "–û–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ", is_correct: true },
      { id: 38, answer_text: "–í–æ–¥–æ–ø–∞–¥", is_correct: false },
      { id: 39, answer_text: "Agile", is_correct: false },
      { id: 40, answer_text: "Scrum", is_correct: false }
    ]
  }
];

    let currentQuestionIndex = 0;
    let score = 0;
    let userAnswers = [];
    let selectedAnswerId = null;

    function initQuiz() {
      document.getElementById('total-questions-result').textContent = quizData.length;
      updateProgress();
      showQuestion();
    }

    function showQuestion() {
      const quizBox = document.getElementById('quiz-box');
      quizBox.innerHTML = '';
      if (currentQuestionIndex >= quizData.length) {
        showResults();
        return;
      }

      const question = quizData[currentQuestionIndex];
      const questionElement = document.createElement('div');
      questionElement.className = 'question-box fade-in';
      questionElement.innerHTML = `
        <div class="question-text">${question.question_text}</div>
        <div class="answers-container">
          ${question.answers.map(answer => `
            <button class="answer-btn" data-id="${answer.id}">${answer.answer_text}</button>
          `).join('')}
        </div>
      `;

      quizBox.appendChild(questionElement);

      document.querySelectorAll('.answer-btn').forEach(button => {
        button.addEventListener('click', () => {
          document.querySelectorAll('.answer-btn').forEach(btn => btn.classList.remove('selected'));
          button.classList.add('selected');
          selectedAnswerId = parseInt(button.dataset.id);
        });
      });
    }

    function nextQuestion() {
      const question = quizData[currentQuestionIndex];

      if (selectedAnswerId != null) {
        const selectedAnswer = question.answers.find(a => a.id === selectedAnswerId);
        userAnswers.push({
          question_id: question.id,
          selected_answer_id: selectedAnswerId,
          is_correct: selectedAnswer.is_correct
        });
        if (selectedAnswer.is_correct) score++;
      } else {
        userAnswers.push({
          question_id: question.id,
          selected_answer_id: null,
          is_correct: false
        });
      }

      currentQuestionIndex++;
      selectedAnswerId = null;
      updateProgress();
      showQuestion();
    }

    function updateProgress() {
      const progressPercent = (currentQuestionIndex / quizData.length) * 100;
      document.getElementById('progress-bar').style.width = `${progressPercent}%`;
      document.getElementById('progress-text').textContent =
        `–í–æ–ø—Ä–æ—Å ${Math.min(currentQuestionIndex + 1, quizData.length)} –∏–∑ ${quizData.length}`;
    }

    function showResults() {
      document.getElementById('quiz-box').style.display = 'none';
      document.querySelector('.controls').style.display = 'none';
      document.getElementById('result-box').style.display = 'block';
      document.getElementById('final-score').textContent = score;

      const percentage = (score / quizData.length) * 100;
      const emojiElement = document.getElementById('result-emoji');
      emojiElement.textContent = percentage >= 80 ? 'üòç' : percentage >= 50 ? 'üòä' : 'üò¢';
    }

function generateCertificate() {
    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const userName = document.getElementById('username').value || '–ê–Ω–æ–Ω–∏–º';
    const dateStr = new Date().toLocaleDateString('ru-RU');
    const certElement = document.getElementById('certificate-template');
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —à–∞–±–ª–æ–Ω
    document.getElementById('certificate-name').textContent = userName;
    document.getElementById('certificate-score').textContent = score;
    document.getElementById('certificate-total').textContent = quizData.length;
    document.getElementById('certificate-date').textContent = dateStr;

    // –í—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
    certElement.style.display = 'block';
    certElement.style.position = 'fixed';
    certElement.style.left = '0';
    certElement.style.top = '0';
    certElement.style.zIndex = '99999';
    certElement.style.width = '800px';
    certElement.style.height = '600px';

    // –ñ–¥–µ–º —Ä–µ—Ä–µ–Ω–¥–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    setTimeout(() => {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF({
            orientation: 'landscape',
            unit: 'mm',
            format: 'a4'
        });

        html2canvas(certElement, {
            scale: 2, // –£–ª—É—á—à–∞–µ–º –∫–∞—á–µ—Å—Ç–≤–æ
            logging: false,
            useCORS: true,
            width: 800,
            height: 600,
            scrollX: 0,
            scrollY: 0
        }).then(canvas => {
            // –°—Ä–∞–∑—É —Å–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Å–ª–µ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
            certElement.style.display = 'none';
            certElement.style.position = 'absolute';
            certElement.style.left = '-9999px';

            const imgData = canvas.toDataURL('image/png');
            const pdfWidth = pdf.internal.pageSize.getWidth();
            const pdfHeight = (canvas.height * pdfWidth) / canvas.width;

            pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
            pdf.save(`IT_–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç_${userName.replace(/\s+/g, '_')}.pdf`);
        }).catch(err => {
            console.error("–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:", err);
            alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.");
            // –í—Å–µ —Ä–∞–≤–Ω–æ —Å–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏
            certElement.style.display = 'none';
            certElement.style.position = 'absolute';
            certElement.style.left = '-9999px';
        });
    }, 100); // –î–∞–µ–º 100–º—Å –Ω–∞ –æ—Ç—Ä–∏—Å–æ–≤–∫—É DOM
}


    function restartQuiz() {
      currentQuestionIndex = 0;
      score = 0;
      userAnswers = [];
      selectedAnswerId = null;

      document.getElementById('quiz-box').style.display = 'block';
      document.querySelector('.controls').style.display = 'block';
      document.getElementById('result-box').style.display = 'none';
      document.getElementById('username').value = '';

      updateProgress();
      showQuestion();
    }

    document.addEventListener('DOMContentLoaded', () => {
      initQuiz();
      document.getElementById('next-btn').addEventListener('click', nextQuestion);
    });

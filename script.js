
  
    const quizData = [
      {
        id: 1,
        question_text: "–ö–∞–∫–∞—è –∞–±—Ä–µ–≤–∏–∞—Ç—É—Ä–∞ –Ω–∞—à–µ–≥–æ –∫–æ–ª–ª–µ–¥–∂–∞?",
        answers: [
          { id: 1, answer_text: "–ì–ü–û–ê–° –ò–° –ë–ö", is_correct: false },
          { id: 2, answer_text: "–ò–°–ò–ü –£ –î–ï–î–ê", is_correct: false },
          { id: 3, answer_text: "–ê–ö–°–ñ–ö–•", is_correct: false },
          { id: 4, answer_text: "–ì–ü–û–ê–£ –ê–û –ê–ü–ö", is_correct: true }
        ]
      },
      {
        id: 2,
        question_text: "–ö–∞–∫—É—é –ø–∞—Ä–æ–¥—É —Å–æ–±–∞–∫ –ª—é–±–∏—Ç –¢–æ—Ä–±–∞ –ù–∏–Ω–∞ –í–∏–∫—Ç–æ—Ä–æ–≤–Ω–∞?",
        answers: [
          { id: 5, answer_text: "–ú–æ–ø—Å", is_correct: true },
          { id: 6, answer_text: "–ß–∞—É —á–∞—É", is_correct: false },
          { id: 7, answer_text: "–ö–æ—Ä–≥–∏", is_correct: false },
          { id: 8, answer_text: "–ú–µ–π–Ω–∫—É–Ω", is_correct: false }
        ]
      },
      {
        id: 3,
        question_text: "–ü—Ä–∏ –ø–æ–º–æ—â–∏ –∫–∞–∫–æ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å—Ç—É–¥–µ–Ω—Ç –º–æ–∂–µ—Ç –∑–∞–π—Ç–∏ –≤ –∫–æ–ª–ª–µ–¥–∂ –ø—Ä–∏ –∑–∞–±—ã—Ç–æ–º –ø—Ä–æ–ø—É—Å–∫–µ?",
        answers: [
          { id: 9, answer_text: "–°–ù–ò–õ–°", is_correct: false },
          { id: 10, answer_text: "–ò–ù–ù", is_correct: false },
          { id: 11, answer_text: "–°—Ç—É–¥–µ–Ω—á–µ—Å–∫–∏–π –±–∏–ª–µ—Ç", is_correct: true },
          { id: 12, answer_text: "–ü–æ–ª–∏—Å", is_correct: false }
        ]
      },
      {
        id: 4,
        question_text: "–ö–∞–∫–æ–π –Ω–æ–º–µ—Ä –∫–∞–±–∏–Ω–µ—Ç–∞ —É –∑–∞–≤–µ–¥—É—é—â–µ–≥–æ –æ—Ç–¥–µ–ª–µ–Ω–µ–∏–º?",
        answers: [
          { id: 13, answer_text: "‚Ññ23", is_correct: false },
          { id: 14, answer_text: "‚Ññ33", is_correct: true },
          { id: 15, answer_text: "‚Ññ35", is_correct: false },
          { id: 16, answer_text: "‚Ññ15", is_correct: false }
        ]
      },
      {
        id: 5,
        question_text: "–í –∫–∞–∫–æ–µ –≤—Ä–µ–º—è –Ω–∞—á–∏–Ω–∞–µ—Ç—å—Å—è –æ–±–µ–¥ –≤ –í–¢-–ü–¢?",
        answers: [
          { id: 17, answer_text: "11:15", is_correct: true },
          { id: 18, answer_text: "12:30", is_correct: false },
          { id: 19, answer_text: "11:00", is_correct: false },
          { id: 20, answer_text: "10:30", is_correct: false }
        ]
      },
      {
        id: 6,
        question_text: "–ö–∞–∫ –∑–æ–≤—É—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞?",
        answers: [
          { id: 21, answer_text: "–ú–∞—Ä–∞—Ç –ò–≥–Ω–∞—Ç–æ–≤–∏—á", is_correct: false },
          { id: 22, answer_text: "–í–∞—Å–∏–ª–∏–π –î–µ–Ω–∏—Å–æ–≤–∏—á", is_correct: false },
          { id: 23, answer_text: "–ê–Ω–¥—Ä–µ–π –ò–≥–æ—Ä–µ–≤–∏—á", is_correct: true },
          { id: 24, answer_text: "–î–º–∏—Ç—Ä–∏–π –ï–≤–≥–µ–Ω—å–µ–≤–∏—á", is_correct: false }
        ]
      },
      {
      id: 7,
      question_text: "–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –∫—Ä–∞—Å–Ω–∞—è –æ–±–ª–æ–∂–∫–∞ –∑–∞—á–µ—Ç–Ω–æ–π –∫–Ω–∏–∂–∫–∏?",
      answers: [
        { id: 25, answer_text: "–û—Ç–ª–∏—á–Ω–∏–∫ —É—á–µ–±—ã", is_correct: true },
        { id: 26, answer_text: "–î–æ–ª–≥–∏ –ø–æ –ø—Ä–µ–¥–º–µ—Ç–∞–º", is_correct: false },
        { id: 27, answer_text: "–ó–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç—å –ø–æ –æ–ø–ª–∞—Ç–µ", is_correct: false },
        { id: 28, answer_text: "–£—á–∞—Å—Ç–∏–µ –≤ —Å—Ç—É–¥—Å–æ–≤–µ—Ç–µ", is_correct: false }
      ]
      },
      {
      id: 8,
      question_text: "–ù–∞ –∫–∞–∫–æ–º —ç—Ç–∞–∂–µ –≤—ã–≤–µ—à—ã–≤–∞–≤–∞–µ—Ç—å—Å—è —Ä–∞—Å—Å–ø–∏—Å–∞–Ω–∏–µ?",
      answers: [
    { id: 29, answer_text: "–ù–∞ —Ç—Ä–µ—Ç—å–µ–º —ç—Ç–∞–∂–µ.", is_correct: false },
    { id: 30, answer_text: "–ù–∞ –ø–µ—Ä–≤–æ–º —ç—Ç–∞–∂–µ.", is_correct: true },
    { id: 31, answer_text: "–ù–∞ –≤—Ç–æ—Ä–æ–º —ç—Ç–∞–∂–µ.", is_correct: false },
  ]
      },
      {
      id: 9,
      question_text: "–ö–∞–∫–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –±–∞–∑–æ–≤–∞—è —Å—Ç–∏–ø–µ–Ω–¥–∏—è –≤ –Ω–∞—à–µ–º –∫–æ–ª–ª–µ–¥–∂–µ?",
      answers: [
    { id: 32, answer_text: "700-900 —Ä—É–±.", is_correct: true },
    { id: 33, answer_text: "500-600 —Ä—É–±.", is_correct: false },
    { id: 34, answer_text: "1000-1200 —Ä—É–±.", is_correct: false },
  ]
      },

    ];

    let currentQuestionIndex = 0;
    let score = 0;
    let userAnswers = [];
    let selectedAnswerId = null;

    function initQuiz() {
      document.getElementById('total-questions-result').textContent = quizData.length;
      updateProgress();
      showQuestion();
    }

    function showQuestion() {
      const quizBox = document.getElementById('quiz-box');
      quizBox.innerHTML = '';
      if (currentQuestionIndex >= quizData.length) {
        showResults();
        return;
      }

      const question = quizData[currentQuestionIndex];
      const questionElement = document.createElement('div');
      questionElement.className = 'question-box fade-in';
      questionElement.innerHTML = `
        <div class="question-text">${question.question_text}</div>
        <div class="answers-container">
          ${question.answers.map(answer => `
            <button class="answer-btn" data-id="${answer.id}">${answer.answer_text}</button>
          `).join('')}
        </div>
      `;

      quizBox.appendChild(questionElement);

      document.querySelectorAll('.answer-btn').forEach(button => {
        button.addEventListener('click', () => {
          document.querySelectorAll('.answer-btn').forEach(btn => btn.classList.remove('selected'));
          button.classList.add('selected');
          selectedAnswerId = parseInt(button.dataset.id);
        });
      });
    }

    function nextQuestion() {
      const question = quizData[currentQuestionIndex];

      if (selectedAnswerId != null) {
        const selectedAnswer = question.answers.find(a => a.id === selectedAnswerId);
        userAnswers.push({
          question_id: question.id,
          selected_answer_id: selectedAnswerId,
          is_correct: selectedAnswer.is_correct
        });
        if (selectedAnswer.is_correct) score++;
      } else {
        userAnswers.push({
          question_id: question.id,
          selected_answer_id: null,
          is_correct: false
        });
      }

      currentQuestionIndex++;
      selectedAnswerId = null;
      updateProgress();
      showQuestion();
    }

    function updateProgress() {
      const progressPercent = (currentQuestionIndex / quizData.length) * 100;
      document.getElementById('progress-bar').style.width = `${progressPercent}%`;
      document.getElementById('progress-text').textContent =
        `–í–æ–ø—Ä–æ—Å ${Math.min(currentQuestionIndex + 1, quizData.length)} –∏–∑ ${quizData.length}`;
    }

    function showResults() {
      document.getElementById('quiz-box').style.display = 'none';
      document.querySelector('.controls').style.display = 'none';
      document.getElementById('result-box').style.display = 'block';
      document.getElementById('final-score').textContent = score;

      const percentage = (score / quizData.length) * 100;
      const emojiElement = document.getElementById('result-emoji');
      emojiElement.textContent = percentage >= 80 ? 'üòç' : percentage >= 50 ? 'üòä' : 'üò¢';
    }

function generateCertificate() {
    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const userName = document.getElementById('username').value || '–ê–Ω–æ–Ω–∏–º';
    const dateStr = new Date().toLocaleDateString('ru-RU');
    const certElement = document.getElementById('certificate-template');
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —à–∞–±–ª–æ–Ω
    document.getElementById('certificate-name').textContent = userName;
    document.getElementById('certificate-score').textContent = score;
    document.getElementById('certificate-total').textContent = quizData.length;
    document.getElementById('certificate-date').textContent = dateStr;

    // –í—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
    certElement.style.display = 'block';
    certElement.style.position = 'fixed';
    certElement.style.left = '0';
    certElement.style.top = '0';
    certElement.style.zIndex = '99999';
    certElement.style.width = '800px';
    certElement.style.height = '600px';

    // –ñ–¥–µ–º —Ä–µ—Ä–µ–Ω–¥–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    setTimeout(() => {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF({
            orientation: 'landscape',
            unit: 'mm',
            format: 'a4'
        });

        html2canvas(certElement, {
            scale: 2, // –£–ª—É—á—à–∞–µ–º –∫–∞—á–µ—Å—Ç–≤–æ
            logging: false,
            useCORS: true,
            width: 800,
            height: 600,
            scrollX: 0,
            scrollY: 0
        }).then(canvas => {
            // –°—Ä–∞–∑—É —Å–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Å–ª–µ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
            certElement.style.display = 'none';
            certElement.style.position = 'absolute';
            certElement.style.left = '-9999px';

            const imgData = canvas.toDataURL('image/png');
            const pdfWidth = pdf.internal.pageSize.getWidth();
            const pdfHeight = (canvas.height * pdfWidth) / canvas.width;

            pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
            pdf.save(`–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è_–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç_${userName.replace(/\s+/g, '_')}.pdf`);
        }).catch(err => {
            console.error("–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞:", err);
            alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.");
            // –í—Å–µ —Ä–∞–≤–Ω–æ —Å–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏
            certElement.style.display = 'none';
            certElement.style.position = 'absolute';
            certElement.style.left = '-9999px';
        });
    }, 100); // –î–∞–µ–º 100–º—Å –Ω–∞ –æ—Ç—Ä–∏—Å–æ–≤–∫—É DOM
}


    function restartQuiz() {
      currentQuestionIndex = 0;
      score = 0;
      userAnswers = [];
      selectedAnswerId = null;

      document.getElementById('quiz-box').style.display = 'block';
      document.querySelector('.controls').style.display = 'block';
      document.getElementById('result-box').style.display = 'none';
      document.getElementById('username').value = '';

      updateProgress();
      showQuestion();
    }

    document.addEventListener('DOMContentLoaded', () => {
      initQuiz();
      document.getElementById('next-btn').addEventListener('click', nextQuestion);
    });
